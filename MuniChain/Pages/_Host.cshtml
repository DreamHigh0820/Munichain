@page "/"
@namespace UI.Pages
@using Shared.Models.Chat;
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@{
    Layout = "_Layout";
}

@{
    var initState = new InitialState
            {
                Cookie = HttpContext.Request.Cookies.FirstOrDefault(c => c.Key == ".AspNetCore.Cookies").Value
            };
}

<div id="components-reconnect-modal" class="my-reconnect-modal components-reconnect-hide">
    <div class="show relative z-50" aria-labelledby="modal-title" role="dialog" aria-modal="true">
        <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"></div>
        <div class="fixed inset-0 z-20 overflow-y-auto">
            <div class="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0">
                <div class="relative transform overflow-hidden rounded-lg bg-white px-4 pt-5 pb-4 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-sm sm:p-6">
                    <div>
                        <div class="mx-auto flex items-center justify-center rounded-full text-emerald-600">
                            <i class="fa-solid fa-circle-notch fa-spin fa-2xl"></i>
                        </div>
                        <div class="mt-3 text-center sm:mt-5">
                            <h3 class="text-lg font-medium leading-6 text-gray-900" id="modal-title">Reconnecting</h3>
                            <div class="mt-2">
                                <p class="text-sm text-gray-500">Attempting to reconnect to the server.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="failed relative z-50" aria-labelledby="modal-title" role="dialog" aria-modal="true">
        <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"></div>
        <div class="fixed inset-0 z-20 overflow-y-auto">
            <div class="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0">
                <div class="relative transform overflow-hidden rounded-lg bg-white px-4 pt-5 pb-4 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-sm sm:p-6">
                    <div>
                        <div class="mx-auto flex items-center justify-center rounded-full text-red-500">
                            <i class="fa-solid fa-circle-exclamation fa-2xl"></i>
                        </div>
                        <div class="mt-3 text-center sm:mt-5">
                            <h3 class="text-lg font-medium leading-6 text-gray-900" id="modal-title">Connection Failed</h3>
                            <div class="mt-2">
                                <p class="text-sm text-gray-500">Please refresh the page and try again.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="failed relative z-50" aria-labelledby="modal-title" role="dialog" aria-modal="true">
        <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"></div>
        <div class="fixed inset-0 z-20 overflow-y-auto">
            <div class="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0">
                <div class="relative transform overflow-hidden rounded-lg bg-white px-4 pt-5 pb-4 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-sm sm:p-6">
                    <div>
                        <div class="mx-auto flex items-center justify-center rounded-full text-red-500">
                            <i class="fa-solid fa-circle-exclamation fa-2xl"></i>
                        </div>
                        <div class="mt-3 text-center sm:mt-5">
                            <h3 class="text-lg font-medium leading-6 text-gray-900" id="modal-title">Disconnected</h3>
                            <div class="mt-2">
                                <p class="text-sm text-gray-500">Please refresh the page and try again.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<component type="typeof(App)" render-mode="Server" param-InitialState="@initState" />

<style>
    .components-reconnect-hide > div {
        display: none;
    }
    .components-reconnect-show > div {
        display: none;
    }
    .components-reconnect-show > .show {
        display: block;
    }
    .components-reconnect-failed > div {
        display: none;
    }
    .components-reconnect-failed > .failed {
        display: block;
    }
    .components-reconnect-refused > div {
        display: none;
    }
    .components-reconnect-refused > .refused {
        display: block;
    }
</style>